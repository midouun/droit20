<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุงูุชูุธูู ุงููุถุงุฆู | ุณูุฉ ุฃููู ุญููู</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">

    <style>
        :root {
            --brand-color: #1a2a6c; /* ุฃุฒุฑู ุฑุณูู */
            --brand-accent: #b21f1f; /* ุฃุญูุฑ (ุนูู ุงูุฌุฒุงุฆุฑ) */
            --brand-gold: #fdbb2d;   /* ุฐูุจู ููุชููุฒ */
            --bg-body: #f4f7f6;
            --bg-card: #ffffff;
            --radius: 16px;
        }

        body.dark-mode {
            --brand-color: #ecf0f1;
            --bg-body: #0f2027;
            --bg-card: #203a43;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Tajawal', sans-serif; outline: none; }
        body { background: var(--bg-body); color: #2c3e50; height: 100vh; overflow: hidden; transition: 0.3s; }
        body.dark-mode { color: #ecf0f1; }

        /* --- ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ: ูุงุฆูุฉ ุงูุงูุชุญุงูุงุช --- */
        #main-menu-view {
            padding: 40px; height: 100%; overflow-y: auto; text-align: center;
            background: linear-gradient(135deg, rgba(26, 42, 108, 0.05) 0%, rgba(178, 31, 31, 0.05) 100%);
        }
        .header-title { font-size: 2.5rem; font-weight: 900; color: var(--brand-color); margin-bottom: 5px; }
        .dark-mode .header-title { color: var(--brand-gold); }
        .header-subtitle { font-size: 1.2rem; opacity: 0.8; margin-bottom: 40px; color: var(--brand-accent); font-weight: bold; }
        
        .exams-grid {
            display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; max-width: 1000px; margin: 0 auto;
        }
        
        .exam-card {
            background: var(--bg-card); padding: 30px; border-radius: var(--radius);
            box-shadow: 0 10px 20px rgba(0,0,0,0.05); cursor: pointer; transition: 0.3s;
            border-top: 5px solid var(--brand-color); position: relative; text-align: right;
        }
        .exam-card:hover { transform: translateY(-8px); border-top-color: var(--brand-gold); }
        .exam-icon { font-size: 2.5rem; margin-bottom: 15px; display: block; }
        .exam-title { font-size: 1.3rem; font-weight: 800; margin-bottom: 8px; }
        .exam-desc { font-size: 0.9rem; opacity: 0.7; line-height: 1.6; }
        
        /* --- ูุงุฌูุฉ ุงูุงูุชุญุงู ุงูุฏุงุฎูู --- */
        #app-view { display: none; height: 100%; }
        
        .sidebar {
            width: 280px; background: linear-gradient(180deg, #1a2a6c 0%, #2a4858 100%);
            color: white; padding: 25px; display: flex; flex-direction: column;
            box-shadow: 5px 0 20px rgba(0,0,0,0.1);
        }
        .back-btn {
            background: rgba(255,255,255,0.15); border: none; color: white; padding: 10px;
            border-radius: 10px; cursor: pointer; margin-bottom: 30px; display: flex; align-items: center; gap: 10px;
            font-weight: bold; transition: 0.2s;
        }
        .back-btn:hover { background: var(--brand-gold); color: #000; }
        
        .nav-menu { display: flex; flex-direction: column; gap: 12px; }
        .nav-btn {
            background: transparent; border: none; color: rgba(255,255,255,0.8); padding: 15px;
            text-align: right; cursor: pointer; border-radius: 12px; font-size: 1rem; transition: 0.2s;
            display: flex; align-items: center; gap: 15px;
        }
        .nav-btn:hover, .nav-btn.active { background: rgba(255,255,255,0.1); color: #fff; font-weight: bold; }
        .nav-btn.active { border-right: 4px solid var(--brand-gold); }

        .main-content { flex: 1; padding: 40px; overflow-y: auto; background: var(--bg-body); }
        
        /* Cards & Content */
        .content-card {
            background: var(--bg-card); padding: 30px; border-radius: var(--radius); margin-bottom: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05); border-right: 4px solid var(--brand-color); animation: fadeIn 0.4s;
        }
        .content-card h3 { color: var(--brand-color); margin-bottom: 15px; font-size: 1.4rem; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .dark-mode .content-card h3 { color: var(--brand-gold); }
        .citation { display: block; margin-top: 10px; font-size: 0.85rem; color: #7f8c8d; font-style: italic; background: rgba(0,0,0,0.03); padding: 5px 10px; border-radius: 5px; width: fit-content; }

        /* Quiz UI */
        .option-btn {
            display: block; width: 100%; padding: 18px 25px; margin: 15px 0; background: var(--bg-card);
            border: 1px solid rgba(0,0,0,0.1); border-radius: 12px; cursor: pointer; font-size: 1.1rem;
            transition: 0.2s; text-align: right; color: inherit; font-weight: 600;
        }
        .option-btn:hover:not(.disabled) { border-color: var(--brand-color); background: rgba(26, 42, 108, 0.05); }
        .option-btn.correct { background: #d4edda; border-color: #28a745; color: #155724; }
        .option-btn.wrong { background: #f8d7da; border-color: #dc3545; color: #721c24; }
        
        .btn-primary {
            background: var(--brand-color); color: white; border: none; padding: 12px 35px;
            border-radius: 30px; cursor: pointer; font-size: 1.1rem; font-weight: bold; margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2); transition: 0.3s;
        }
        .btn-primary:hover { background: var(--brand-accent); transform: translateY(-3px); }

        .hidden { display: none !important; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Mobile */
        @media (max-width: 768px) {
            #app-view { flex-direction: column; }
            .sidebar { width: 100%; padding: 15px; flex-direction: row; justify-content: space-between; align-items: center; }
            .nav-menu { flex-direction: row; }
            .nav-btn span { display: none; }
            .back-btn span { display: none; }
            .main-content { padding: 20px; }
        }
    </style>
</head>
<body>

    <div id="main-menu-view">
        <h1 class="header-title">โ๏ธ ุงูููุตุฉ ุงููุถุงุฆูุฉ</h1>
        <p class="header-subtitle">ุณูุฉ ุฃููู ุญููู - ูููุงุณ ุงูุชูุธูู ุงููุถุงุฆู</p>
        
        <div class="exams-grid" id="exams-container">
            </div>

        <div style="margin-top: 50px;">
            <button onclick="document.body.classList.toggle('dark-mode')" style="background:transparent; border:1px solid #ccc; padding:8px 20px; border-radius:20px; cursor:pointer; color:inherit">๐ ุงููุถุน ุงููููู</button>
        </div>
    </div>

    <div id="app-view">
        <aside class="sidebar">
            <button class="back-btn" onclick="app.goHome()">
                <span>โฌ</span> <span>ุงูุนูุฏุฉ ูููุงุฆูุฉ</span>
            </button>
            <h3 id="sidebar-title" style="text-align:center; margin-bottom:20px; font-size:1.1rem; opacity:0.9"></h3>
            
            <nav class="nav-menu">
                <button class="nav-btn active" onclick="app.switchTab('review', this)">
                    <span>๐</span> <span>ุงููุฑุงุฌุนุฉ ูุงูุฏุฑูุณ</span>
                </button>
                <button class="nav-btn" onclick="app.switchTab('quiz', this)">
                    <span>๐</span> <span>ุงูุฃุณุฆูุฉ (QCM)</span>
                </button>
                <button class="nav-btn" onclick="app.switchTab('flashcards', this)">
                    <span>๐ก</span> <span>ุจุทุงูุงุช ุงูุฐุงูุฑุฉ</span>
                </button>
            </nav>
        </aside>

        <main class="main-content">
            <section id="review-tab">
                <div id="content-container"></div>
            </section>

            <section id="quiz-tab" class="hidden">
                <div class="content-card" style="text-align:center; max-width:800px; margin:0 auto">
                    <h2 id="quiz-title-display">ุงุฎุชุจุงุฑ ุงููุนูููุงุช</h2>
                    <p style="margin-bottom:20px; opacity:0.7">ุฃุฌุจ ุนู ุงูุฃุณุฆูุฉ ุงูุชุงููุฉ</p>
                    
                    <div id="quiz-start-btn">
                        <button class="btn-primary" onclick="quizManager.start()">ุงุจุฏุฃ ุงูุงุฎุชุจุงุฑ</button>
                    </div>

                    <div id="quiz-area" class="hidden" style="text-align:right; margin-top:30px">
                        <div style="display:flex; justify-content:space-between; margin-bottom:15px; color:#888">
                            <span id="q-progress">ุณุคุงู 1</span>
                            <span id="score-display">ุงููุชูุฌุฉ: 0</span>
                        </div>
                        <h3 id="q-text" style="font-size:1.5rem; margin-bottom:25px; line-height:1.5"></h3>
                        <div id="q-options"></div>
                        
                        <div id="feedback" class="hidden" style="margin-top:20px; padding:20px; background:rgba(0,0,0,0.03); border-radius:10px">
                            <h4 id="fb-msg" style="margin-bottom:10px"></h4>
                            <p id="fb-exp"></p>
                            <span id="fb-cite" class="citation"></span>
                            <button class="btn-primary" onclick="quizManager.next()">ุงูุชุงูู</button>
                        </div>
                    </div>
                </div>
            </section>

            <section id="flashcards-tab" class="hidden">
                <div class="content-card" style="text-align:center; min-height:350px; display:flex; flex-direction:column; justify-content:center; align-items:center; cursor:pointer" onclick="flashcardManager.flip()">
                    <div id="fc-face">
                        <span style="font-size:3rem; display:block; margin-bottom:20px">โ</span>
                        <h2 id="fc-text">ุงูุณุคุงู ููุง</h2>
                        <p id="fc-sub" style="margin-top:20px; opacity:0.6">(ุงุถุบุท ูููุจ ุงูุจุทุงูุฉ)</p>
                    </div>
                </div>
                <div style="text-align:center">
                    <button class="btn-primary" onclick="flashcardManager.next()">ุงูุจุทุงูุฉ ุงูุชุงููุฉ โก</button>
                </div>
            </section>
        </main>
    </div>

    <script>
        // ==========================================
        // ูุงุนุฏุฉ ุงูุจูุงูุงุช: ููุง ููููู ุฅุถุงูุฉ ุงูุชุญุงูุงุช ุฌุฏูุฏุฉ ูููุณ ุงููููุงุณ
        // ==========================================
        const database = {
            // ุงูุงูุชุญุงู ุงูุดุงูู (ูุญุชูู ุนูู ูู ุดูุก)
            "comprehensive_exam": {
                title: "ุงูุงุฎุชุจุงุฑ ุงูุดุงูู (ูู ุงูุฏุฑูุณ)",
                desc: "ูุบุทู ุงููุจุงุฏุฆุ ุงููุถุงุก ุงูุนุงุฏูุ ุงูุฅุฏุงุฑูุ ูุงููุณุงุนุฏูู.",
                icon: "๐๏ธ",
                lessons: [
                    {
                        title: "1. ูุจุงุฏุฆ ุงูุชูุธูู ุงููุถุงุฆู",
                        content: `
                        <p><strong>ุญู ุงููุฌูุก ูููุถุงุก:</strong> ุญู ุฏุณุชูุฑู (ู 164-165 ุฏุณุชูุฑ 2020) ูุง ูููู ุงูุชูุงุฒู ุนูู.</p>
                        <p><strong>ุงูุชูุงุถู ุนูู ุฏุฑุฌุชูู:</strong> (ู 169 ุฏุณุชูุฑ) ูุณูุญ ุจุงุณุชุฆูุงู ุงูุฃุญูุงู ุฃูุงู ุฌูุฉ ุฃุนูู (ุงููุฌูุณ ุงููุถุงุฆู ุฃู ุงููุญููุฉ ุงูุฅุฏุงุฑูุฉ ููุงุณุชุฆูุงู).</p>
                        <p><strong>ุงูุนูุงููุฉ:</strong> ุงูุฌูุณุงุช ุนูููุฉ (ู 169 ุฏุณุชูุฑ) ุฅูุง ูู ุญุงูุงุช ูุญุฏุฏุฉ (ุงูุฃุณุฑุฉุ ุงูุฃุญุฏุงุซ) ุญูุงุธุงู ุนูู ุงููุธุงู ุงูุนุงู.</p>`
                    },
                    {
                        title: "2. ุงููุถุงุก ุงูุนุงุฏู (ุงูููุงูู)",
                        content: `
                        [cite_start]<p><strong>ุงููุญููุฉ (ุฏุฑุฌุฉ 1):</strong> ุฐุงุช ุงุฎุชุตุงุต ุนุงู. ุงูุฃุตู ูููุง ุงููุถุงุก ุงููุฑุฏู (ูุง ุนุฏุง ุงูุงุฌุชูุงุนูุ ุงูุชุฌุงุฑูุ ุงูุฃุญุฏุงุซ)[cite: 2205].</p>
                        [cite_start]<p><strong>ุงููุฌูุณ ุงููุถุงุฆู (ุฏุฑุฌุฉ 2):</strong> ููุตู ูู ุงุณุชุฆูุงู ุฃุญูุงู ุงููุญุงูู ุจุชุดูููุฉ ุฌูุงุนูุฉ (3 ูุถุงุฉ)[cite: 2267].</p>
                        <p><strong>ุงููุญููุฉ ุงูุนููุง:</strong> ูุญููุฉ ูุงููู (ููุณุช ุฏุฑุฌุฉ ุซุงูุซุฉ). [cite_start]ุชุชููู ูู 7 ุบุฑู (ูุฏููุฉุ ุนูุงุฑูุฉุ ุชุฌุงุฑูุฉ...)[cite: 2471].</p>`
                    },
                    {
                        title: "3. ุงููุถุงุก ุงูุฅุฏุงุฑู",
                        content: `
                        [cite_start]<p><strong>ุงููุญุงูู ุงูุฅุฏุงุฑูุฉ:</strong> ุฌูุฉ ุงูููุงูุฉ ุงูุนุงูุฉ ูู ุงูููุงุฒุนุงุช ุงูุฅุฏุงุฑูุฉ[cite: 2540].</p>
                        [cite_start]<p><strong>ุงููุญุงูู ุงูุฅุฏุงุฑูุฉ ููุงุณุชุฆูุงู:</strong> ุงุณุชุญุฏุซุช ุจุงููุงููู 22/07 ูุชูุฑูุณ ูุจุฏุฃ ุงูุชูุงุถู ุนูู ุฏุฑุฌุชูู ุฅุฏุงุฑูุงู[cite: 2576].</p>
                        [cite_start]<p><strong>ูุฌูุณ ุงูุฏููุฉ:</strong> ููุฆุฉ ููููุฉ ูุฃุนูุงู ุงูุฌูุงุช ุงูุฅุฏุงุฑูุฉ ููู ุฏูุฑ ุงุณุชุดุงุฑู[cite: 2600].</p>`
                    },
                    {
                        title: "4. ุงููุญุงูู ุงููุชุฎุตุตุฉ (ุฌุฏูุฏ)",
                        content: `
                        [cite_start]<p><strong>ุงููุญููุฉ ุงูุชุฌุงุฑูุฉ ุงููุชุฎุตุตุฉ:</strong> (ูุงููู 22/13) ุชุชุดูู ูู ุฑุฆูุณ ู4 ูุณุงุนุฏูู ุฎุจุฑุงุก[cite: 2337].</p>
                        [cite_start]<p><strong>ุงููุญููุฉ ุงูุนุณูุฑูุฉ:</strong> ุชุชุจุน ูุฒุงุฑุฉ ุงูุฏูุงุน ูุชุฎุชุต ุจุงูุฌุฑุงุฆู ุงูุนุณูุฑูุฉ[cite: 2360].</p>`
                    }
                ],
                questions: [
                    { q: "ูุง ูู ุชุดูููุฉ ุงููุญููุฉ ุงูุชุฌุงุฑูุฉ ุงููุชุฎุตุตุฉุ", opts: ["ูุงุถู ูุฑุฏ", "3 ูุถุงุฉ", "ูุงุถู ุฑุฆูุณ ู4 ูุณุงุนุฏูู"], ans: 2, exp: "ุชุชุดูู ูู ูุงุถู ุฑุฆูุณ ู4 ูุณุงุนุฏูู ููู ุฏุฑุงูุฉ ุจุงููุณุงุฆู ุงูุชุฌุงุฑูุฉ.", cite: "ุงููุงุฏุฉ 536 ููุฑุฑ 2" },
                    { q: "ูู ููุตู ูู ุชูุงุฒุน ุงูุงุฎุชุตุงุต ุจูู ุงููุธุงูููุ", opts: ["ุงููุญููุฉ ุงูุนููุง", "ูุญููุฉ ุงูุชูุงุฒุน", "ูุฌูุณ ุงูุฏููุฉ"], ans: 1, exp: "ูุญููุฉ ุงูุชูุงุฒุน ูู ุงูููุฆุฉ ุงููุญูุฏุฉ ุงููุฎุชุตุฉ ุฏุณุชูุฑูุงู ุจุฐูู.", cite: "ู 152 ุฏุณุชูุฑ" },
                    { q: "ูููุฉ ุงุณุชุฆูุงู ุฃุญูุงู ูุญููุฉ ุงูุฌูุงูุงุช ุงูุงุจุชุฏุงุฆูุฉุ", opts: ["8 ุฃูุงู", "10 ุฃูุงู", "15 ูููุงู"], ans: 1, exp: "ุงููููุฉ ูู 10 ุฃูุงู ูู ุชุงุฑูุฎ ุงููุทู ุจุงูุญูู.", cite: "ูุงููู ุงูุฅุฌุฑุงุกุงุช ุงูุฌุฒุงุฆูุฉ" },
                    { q: "ูุนุชุจุฑ ุงููุฌูุณ ุงููุถุงุฆู:", opts: ["ุฏุฑุฌุฉ ุซุงูุซุฉ", "ุฏุฑุฌุฉ ุซุงููุฉ", "ูุญููุฉ ููุถ"], ans: 1, exp: "ูู ุฏุฑุฌุฉ ุซุงููุฉ ููุธุฑ ูู ุงุณุชุฆูุงู ุฃุญูุงู ุงููุญุงูู.", cite: "ูุงููู 22/10" },
                    { q: "ุนุฏุฏ ูุถุงุฉ ูุญููุฉ ุงูุชูุงุฒุนุ", opts: ["5 ูุถุงุฉ", "7 ูุถุงุฉ", "9 ูุถุงุฉ"], ans: 1, exp: "ุชุชููู ูู 7 ูุถุงุฉ: ุฑุฆูุณุ 3 ูู ุงููุญููุฉ ุงูุนููุงุ 3 ูู ูุฌูุณ ุงูุฏููุฉ.", cite: "ุงููุงููู ุงูุนุถูู 98/03" }
                ],
                flashcards: [
                    { q: "ุชุนุฑูู ุงููุญุถุฑ ุงููุถุงุฆู", a: "ุถุงุจุท ุนูููู ูููู ุจุงูุชุจููุบ ูุชูููุฐ ุงูุฃุญูุงู", cite: "ูุงููู 06/03" },
                    { q: "ุงูุบุฑู ุงููุฌุชูุนุฉ", a: "ุงุฌุชูุงุน ุบุฑู ุงููุญููุฉ ุงูุนููุง ูุชูุญูุฏ ุงูุงุฌุชูุงุฏ", cite: "ูุงููู ุนุถูู" },
                    { q: "ุณู ุงููุจูู ูู ุงููุถุงุก", a: "ูุง ุจูู 27 ู 40 ุณูุฉ", cite: "ุงููุงููู ุงูุฃุณุงุณู ูููุถุงุก" }
                ]
            },

            // ุงูุชุญุงู ุฌุฒุฆู 1: ุงููุถุงุก ุงูุนุงุฏู ููุท (ูุซุงู ููุชูุณุน)
            "ordinary_exam": {
                title: "ุงุฎุชุจุงุฑ ุงููุถุงุก ุงูุนุงุฏู",
                desc: "ูุฑูุฒ ููุท ุนูู ุงููุญุงููุ ุงููุฌุงูุณุ ูุงููุญููุฉ ุงูุนููุง.",
                icon: "โ๏ธ",
                lessons: [
                    [cite_start]{ title: "ุงููุญููุฉ ุงูุนููุง", content: "<p>ุชุชููู ูู 7 ุบุฑู ูุชุฑุงูุจ ุชุทุจูู ุงููุงููู[cite: 2471].</p>" }
                ],
                questions: [
                    { q: "ูู ุนุฏุฏ ุบุฑู ุงููุญููุฉ ุงูุนููุงุ", opts: ["5", "7", "10"], ans: 1, exp: "ุนุฏุฏูุง 7 ุบุฑู ูุชุฎุตุตุฉ.", cite: "ุงููุงููู ุงูุนุถูู" }
                ],
                flashcards: [
                    { q: "ุงููุญููุฉ ุงูุนููุง", a: "ูุญููุฉ ูุงููู ูููุณุช ูุญููุฉ ููุถูุน" }
                ]
            },

             // ุงูุชุญุงู ุฌุฒุฆู 2: ุฃุนูุงู ุงููุถุงุก
             "auxiliaries_exam": {
                title: "ุงุฎุชุจุงุฑ ูุณุงุนุฏู ุงููุถุงุก",
                desc: "ุฃุณุฆูุฉ ุญูู ุงููุญุงูููุ ุงูููุซูููุ ูุงููุญุถุฑูู.",
                icon: "๐ฅ",
                lessons: [
                    [cite_start]{ title: "ุงููุญุงูู", content: "<p>ูููุฉ ุญุฑุฉ ูุณุชููุฉุ ูุดุชุฑุท ุดูุงุฏุฉ ุงูููุงุกุฉ (CAPA)[cite: 2756].</p>" }
                ],
                questions: [
                    { q: "ูู ูุญุฑุฑ ุงูุนููุฏ ุงูุฑุณููุฉุ", opts: ["ุงููุญุงูู", "ุงูููุซู", "ุงูุฎุจูุฑ"], ans: 1, exp: "ุงูููุซู ูู ุงูุถุงุจุท ุงูุนูููู ุงููุฎูู ุจุฐูู.", cite: "ูุงููู 06/02" }
                ],
                flashcards: [
                    { q: "CAPA", a: "ุดูุงุฏุฉ ุงูููุงุกุฉ ุงูููููุฉ ูููุญุงูุงุฉ" }
                ]
            }
        };

        // ==========================================
        // ุงููุญุฑู ุงูุจุฑูุฌู (ุงูููุทู)
        // ==========================================
        let currentData = null;

        const app = {
            init: function() {
                const container = document.getElementById('exams-container');
                container.innerHTML = '';
                
                Object.keys(database).forEach(key => {
                    const exam = database[key];
                    container.innerHTML += `
                        <div class="exam-card" onclick="app.openExam('${key}')">
                            <span class="exam-icon">${exam.icon}</span>
                            <div class="exam-title">${exam.title}</div>
                            <div class="exam-desc">${exam.desc}</div>
                        </div>
                    `;
                });
            },

            openExam: function(key) {
                currentData = database[key];
                document.getElementById('main-menu-view').classList.add('hidden');
                document.getElementById('app-view').style.display = 'flex'; // ุชูุนูู ุงูู flex
                document.getElementById('sidebar-title').innerText = currentData.title;
                
                // ุชุญููู ุงูุฏุฑูุณ
                const contentDiv = document.getElementById('content-container');
                contentDiv.innerHTML = currentData.lessons.map(l => `
                    <div class="content-card">
                        <h3>${l.title}</h3>
                        <div>${l.content}</div>
                    </div>
                `).join('');
                
                this.switchTab('review');
            },

            goHome: function() {
                document.getElementById('app-view').style.display = 'none';
                document.getElementById('main-menu-view').classList.remove('hidden');
            },

            switchTab: function(tabId, btn) {
                document.getElementById('review-tab').classList.add('hidden');
                document.getElementById('quiz-tab').classList.add('hidden');
                document.getElementById('flashcards-tab').classList.add('hidden');
                document.getElementById(tabId + '-tab').classList.remove('hidden');

                if(btn) {
                    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                }
            }
        };

        const quizManager = {
            index: 0, score: 0,
            
            start: function() {
                this.index = 0; this.score = 0;
                document.getElementById('quiz-start-btn').classList.add('hidden');
                document.getElementById('quiz-area').classList.remove('hidden');
                this.showQuestion();
            },

            showQuestion: function() {
                if(this.index >= currentData.questions.length) {
                    alert(`ุงูุชูู ุงูุงุฎุชุจุงุฑ!\nุงููุชูุฌุฉ ุงูููุงุฆูุฉ: ${this.score} ูู ${currentData.questions.length}`);
                    return location.reload(); // ุฅุนุงุฏุฉ ุชุญููู ููุณูููุฉ
                }
                
                const q = currentData.questions[this.index];
                document.getElementById('q-text').innerText = q.q;
                document.getElementById('q-progress').innerText = `ุณุคุงู ${this.index + 1} ูู ${currentData.questions.length}`;
                document.getElementById('feedback').classList.add('hidden');
                
                const optsDiv = document.getElementById('q-options');
                optsDiv.innerHTML = '';
                
                q.opts.forEach((opt, i) => {
                    const btn = document.createElement('button');
                    btn.className = 'option-btn';
                    btn.innerText = opt;
                    btn.onclick = () => this.check(i, btn);
                    optsDiv.appendChild(btn);
                });
            },

            check: function(selected, btn) {
                const q = currentData.questions[this.index];
                const allBtns = document.querySelectorAll('.option-btn');
                allBtns.forEach(b => b.classList.add('disabled'));

                document.getElementById('fb-exp').innerText = q.exp;
                document.getElementById('fb-cite').innerText = "ุงููุตุฏุฑ: " + q.cite;
                document.getElementById('feedback').classList.remove('hidden');

                if(selected === q.ans) {
                    this.score++;
                    btn.classList.add('correct');
                    document.getElementById('fb-msg').innerText = "ุฅุฌุงุจุฉ ุตุญูุญุฉ! โ";
                    document.getElementById('fb-msg').style.color = "green";
                } else {
                    btn.classList.add('wrong');
                    allBtns[q.ans].classList.add('correct');
                    document.getElementById('fb-msg').innerText = "ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ โ";
                    document.getElementById('fb-msg').style.color = "red";
                }
                document.getElementById('score-display').innerText = `ุงููุชูุฌุฉ: ${this.score}`;
            },

            next: function() {
                this.index++;
                this.showQuestion();
            }
        };

        const flashcardManager = {
            idx: 0, showAns: false,
            
            flip: function() {
                this.showAns = !this.showAns;
                this.render();
            },
            
            next: function() {
                this.idx = (this.idx + 1) % currentData.flashcards.length;
                this.showAns = false;
                this.render();
            },

            render: function() {
                const card = currentData.flashcards[this.idx];
                const face = document.getElementById('fc-face');
                const text = document.getElementById('fc-text');
                const sub = document.getElementById('fc-sub');
                
                if(this.showAns) {
                    text.innerText = card.a;
                    text.style.color = "#28a745";
                    sub.innerText = `(ุงููุตุฏุฑ: ${card.cite})`;
                } else {
                    text.innerText = card.q;
                    text.style.color = "inherit";
                    sub.innerText = "(ุงุถุบุท ููุนุฑูุฉ ุงูุฅุฌุงุจุฉ)";
                }
            }
        };

        window.onload = () => app.init();
    </script>
</body>
</html>
