<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ù…Ù†ØµØ© Ø§Ù„Ù‚Ø¶Ø§Ø¦ÙŠØ© Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠØ© | Ø§Ù„Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠ</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;900&family=Tajawal:wght@400;500;700;800&display=swap" rel="stylesheet">

    <style>
        /* --- Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª ÙˆØ§Ù„Ø£Ù„ÙˆØ§Ù† (Ù†Ø¸Ø§Ù… Ø§Ù„ØªØµÙ…ÙŠÙ…) --- */
        :root {
            --primary-gradient: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            --accent-gradient: linear-gradient(135deg, #d4af37 0%, #f1c40f 100%);
            --bg-gradient: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
            --bg-card: #ffffff;
            --text-main: #2c3e50;
            --text-light: #ffffff;
            --text-muted: #7f8c8d;
            --glass-bg: rgba(255, 255, 255, 0.75);
            --glass-border: 1px solid rgba(255, 255, 255, 0.6);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.07);
            --card-radius: 24px;
            --success: #00b894;
            --error: #e74c3c;
        }

        body.dark-mode {
            --primary-gradient: linear-gradient(135deg, #243b55 0%, #141e30 100%);
            --bg-gradient: linear-gradient(135deg, #0f2027 0%, #203a43 100%);
            --bg-card: #1e2a3a;
            --text-main: #ecf0f1;
            --text-muted: #bdc3c7;
            --glass-bg: rgba(30, 42, 58, 0.6);
            --glass-border: 1px solid rgba(255, 255, 255, 0.08);
            --glass-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Tajawal', sans-serif; outline: none; -webkit-tap-highlight-color: transparent; }
        body { background: var(--bg-gradient); color: var(--text-main); height: 100vh; overflow: hidden; transition: background 0.5s ease; }

        /* --- Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ø¹Ø§Ù… --- */
        .app-container { display: flex; height: 100%; max-width: 1920px; margin: 0 auto; position: relative; }

        /* Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠØ© */
        .sidebar {
            width: 280px; background: var(--primary-gradient); color: white;
            padding: 30px 20px; display: flex; flex-direction: column;
            box-shadow: 5px 0 30px rgba(0,0,0,0.1); z-index: 50;
        }
        .logo-area { text-align: center; margin-bottom: 40px; pointer-events: none; }
        .logo-icon { font-size: 3rem; margin-bottom: 15px; display: block; }
        .nav-menu { flex: 1; display: flex; flex-direction: column; gap: 12px; }
        
        .nav-btn {
            background: rgba(255,255,255,0.06); border: 1px solid rgba(255,255,255,0.05);
            color: rgba(255,255,255,0.7); padding: 14px 20px; border-radius: 16px;
            text-align: right; font-size: 0.95rem; cursor: pointer;
            display: flex; align-items: center; gap: 15px; transition: all 0.2s ease-out;
            width: 100%; /* Ø¶Ù…Ø§Ù† Ø§Ù„Ø¹Ø±Ø¶ */
        }
        .nav-btn:hover { background: rgba(255,255,255,0.15); color: white; transform: translateX(-3px); }
        .nav-btn.active {
            background: var(--accent-gradient); color: #2c3e50; font-weight: 700;
            border: none; box-shadow: 0 4px 15px rgba(241, 196, 15, 0.25); transform: scale(1.02);
        }

        .sidebar-footer { margin-top: auto; text-align: center; }
        .theme-toggle {
            background: rgba(0,0,0,0.2); border: 1px solid rgba(255,255,255,0.1);
            color: #fff; padding: 8px 15px; border-radius: 20px; cursor: pointer;
            margin: 0 auto 10px; display: inline-flex; align-items: center; gap: 8px;
        }

        /* Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ */
        .main-content { flex: 1; padding: 30px 40px; overflow-y: auto; scroll-behavior: smooth; z-index: 1; }
        
        /* Ø§Ù„Ø±Ø¤ÙˆØ³ ÙˆØ§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
        .header-box {
            background: var(--glass-bg); backdrop-filter: blur(10px); padding: 30px;
            border-radius: var(--card-radius); border: var(--glass-border); margin-bottom: 30px;
        }
        .header-box h2 { font-size: 1.8rem; font-weight: 800; margin-bottom: 5px; color: var(--text-main); }

        .chapters-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 25px; }
        .chapter-card {
            background: var(--bg-card); padding: 25px; border-radius: var(--card-radius);
            box-shadow: var(--glass-shadow); cursor: pointer; transition: transform 0.3s;
            position: relative; overflow: hidden; border: 1px solid rgba(0,0,0,0.05);
        }
        .chapter-card:hover { transform: translateY(-8px); }
        .card-icon { font-size: 2.5rem; display: block; margin-bottom: 15px; }
        .card-title { font-size: 1.2rem; font-weight: 700; margin-bottom: 8px; }
        .card-desc { font-size: 0.9rem; color: var(--text-muted); line-height: 1.5; }

        /* Ø§Ù„Ù‡Ø±Ù… Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠ */
        .pyramid-wrapper {
            background: var(--glass-bg); padding: 30px; border-radius: var(--card-radius);
            margin-bottom: 30px; text-align: center; border: var(--glass-border);
        }
        .pyramid-container { display: flex; flex-direction: column; align-items: center; gap: 6px; }
        .pyramid-level {
            padding: 15px; color: white; font-weight: bold; cursor: pointer;
            transition: 0.2s; border-radius: 8px; width: 80%;
        }
        .pyramid-level:hover { transform: scale(1.03); filter: brightness(1.1); }
        .level-3 { width: 30%; background: #e74c3c; border-radius: 15px 15px 4px 4px; }
        .level-2 { width: 55%; background: #f39c12; }
        .level-1 { width: 80%; background: #27ae60; border-radius: 4px 4px 15px 15px; }

        /* Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± */
        .quiz-intro, .quiz-end {
            background: var(--bg-card); padding: 50px; border-radius: 30px;
            box-shadow: var(--glass-shadow); text-align: center; max-width: 600px; margin: 0 auto;
        }
        .btn-primary {
            background: var(--accent-gradient); color: #2c3e50; border: none;
            padding: 14px 40px; border-radius: 50px; font-size: 1.1rem; font-weight: 800;
            cursor: pointer; box-shadow: 0 8px 20px rgba(241, 196, 15, 0.3); transition: 0.3s;
        }
        .btn-primary:hover { transform: translateY(-3px); }
        
        .progress-container { height: 10px; background: rgba(0,0,0,0.05); border-radius: 20px; margin-bottom: 30px; overflow: hidden; }
        .progress-bar { background: var(--accent-gradient); height: 100%; width: 0%; transition: width 0.5s ease; }
        
        .option-btn {
            width: 100%; background: var(--bg-card); border: 1px solid rgba(0,0,0,0.1);
            padding: 16px 20px; border-radius: 12px; margin-bottom: 12px;
            font-size: 1rem; cursor: pointer; text-align: right; transition: 0.2s;
            color: var(--text-main);
        }
        .option-btn:hover:not(.disabled) { border-color: #3498db; background: rgba(52, 152, 219, 0.05); }
        .option-btn.correct { background: rgba(46, 204, 113, 0.15); border-color: #2ecc71; color: #27ae60; }
        .option-btn.wrong { background: rgba(231, 76, 60, 0.15); border-color: #e74c3c; color: #c0392b; }
        .feedback-box { background: rgba(46, 204, 113, 0.1); padding: 20px; border-radius: 8px; margin-top: 20px; display: none; }

        /* Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„ÙÙ„Ø§Ø´ÙŠØ© */
        .flashcard-wrapper { perspective: 1000px; max-width: 500px; margin: 40px auto; }
        .card { 
            height: 300px; position: relative; transform-style: preserve-3d; transition: transform 0.8s;
            border-radius: 24px; box-shadow: var(--glass-shadow); cursor: pointer;
        }
        .card.is-flipped { transform: rotateY(180deg); }
        .card__face {
            position: absolute; width: 100%; height: 100%; backface-visibility: hidden;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            border-radius: 24px; background: var(--bg-card); padding: 20px; text-align: center;
        }
        .card__face--back { background: var(--primary-gradient); color: white; transform: rotateY(180deg); }
        .fc-controls { display: flex; justify-content: center; gap: 20px; margin-top: 20px; }
        .btn-secondary {
            background: transparent; border: 2px solid var(--text-muted); color: var(--text-main);
            padding: 8px 20px; border-radius: 20px; cursor: pointer;
        }

        /* Ø§Ù„Ø¨Ø­Ø« */
        .search-bar input {
            width: 100%; padding: 18px 25px; border-radius: 16px; border: none;
            background: var(--bg-card); box-shadow: var(--glass-shadow); color: var(--text-main);
        }

        /* Ø§Ù„Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ù†Ø¨Ø«Ù‚Ø© (Modal) */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(5px);
            display: none; justify-content: center; align-items: center; z-index: 1000;
        }
        .modal-box {
            background: var(--bg-card); width: 90%; max-width: 700px; max-height: 85vh;
            border-radius: 24px; padding: 40px; position: relative; overflow-y: auto;
            box-shadow: 0 25px 60px rgba(0,0,0,0.3);
        }
        .close-btn {
            position: absolute; top: 20px; left: 20px; font-size: 2rem;
            background: none; border: none; color: var(--error); cursor: pointer;
        }

        /* Ø§Ù„Ø£Ø¯ÙˆØ§Øª */
        .hidden { display: none !important; }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* Ø§Ù„Ù…ÙˆØ¨Ø§ÙŠÙ„ */
        @media (max-width: 768px) {
            .app-container { flex-direction: column; }
            .sidebar { width: 100%; height: auto; flex-direction: row; align-items: center; padding: 15px; border-radius: 0 0 20px 20px; }
            .logo-area, .sidebar-footer { display: none; }
            .nav-menu { flex-direction: row; justify-content: space-around; width: 100%; }
            .nav-btn { flex-direction: column; padding: 8px; gap: 5px; font-size: 0.7rem; text-align: center; }
            .main-content { padding: 20px; }
        }
    </style>
</head>
<body>

    <div class="app-container">
        <aside class="sidebar">
            <div class="logo-area">
                <div class="logo-icon">âš–ï¸</div>
                <h1>Ø§Ù„Ù‚Ø¶Ø§Ø¡ Ø§Ù„Ø¬Ø²Ø§Ø¦Ø±ÙŠ</h1>
            </div>
            
            <nav class="nav-menu">
                <button class="nav-btn active" onclick="app.switchTab('review', this)">
                    <span>ğŸ“š</span> Ø§Ù„Ù…ÙˆØ³ÙˆØ¹Ø©
                </button>
                <button class="nav-btn" onclick="app.switchTab('quiz', this)">
                    <span>ğŸ“</span> Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
                </button>
                <button class="nav-btn" onclick="app.switchTab('flashcards', this)">
                    <span>ğŸ’¡</span> Ø§Ù„Ø°Ø§ÙƒØ±Ø©
                </button>
                <button class="nav-btn" onclick="app.switchTab('search', this)">
                    <span>ğŸ”</span> Ø§Ù„Ø¨Ø­Ø«
                </button>
            </nav>

            <div class="sidebar-footer">
                <button class="theme-toggle" onclick="app.toggleDarkMode()">
                    ğŸŒ™ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ
                </button>
            </div>
        </aside>

        <main class="main-content">
            
            <section id="review-section" class="tab-content fade-in">
                <header class="header-box">
                    <h2>Ø§Ù„Ù…ÙˆØ³ÙˆØ¹Ø© Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø§Ù„Ø´Ø§Ù…Ù„Ø©</h2>
                    <p>Ù…Ù„Ø®ØµØ§Øª Ø§Ù„Ø¯Ø±ÙˆØ³ ÙˆØ§Ù„Ø³Ù†Ø¯Ø§Øª Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© ÙˆÙÙ‚ Ø¢Ø®Ø± Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª.</p>
                </header>

                <div class="pyramid-wrapper">
                    <h3>Ø§Ù„Ù‡ÙŠÙƒÙ„ Ø§Ù„Ù‡Ø±Ù…ÙŠ Ù„Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù‚Ø¶Ø§Ø¦ÙŠ</h3>
                    <div class="pyramid-container">
                        <div class="pyramid-level level-3" onclick="app.openModal('ordinary_courts')">ğŸ›ï¸ Ø§Ù„Ù…Ø­ÙƒÙ…Ø© Ø§Ù„Ø¹Ù„ÙŠØ§</div>
                        <div class="pyramid-level level-2" onclick="app.openModal('ordinary_courts')">âš–ï¸ Ø§Ù„Ù…Ø¬Ø§Ù„Ø³ Ø§Ù„Ù‚Ø¶Ø§Ø¦ÙŠØ©</div>
                        <div class="pyramid-level level-1" onclick="app.openModal('ordinary_courts')">ğŸ¢ Ø§Ù„Ù…Ø­Ø§ÙƒÙ… Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©</div>
                    </div>
                </div>

                <div class="chapters-grid" id="chapters-container"></div>
            </section>

            <section id="quiz-section" class="tab-content hidden fade-in">
                <header class="header-box">
                    <h2>Ø¨Ù†Ùƒ Ø§Ù„Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø°ÙƒÙŠ</h2>
                    <div class="stats-row" style="margin-top:10px; color:var(--text-muted)">
                        Ø£ÙØ¶Ù„ Ù†ØªÙŠØ¬Ø©: <span id="high-score" style="color:var(--success); font-weight:bold">0%</span>
                    </div>
                </header>

                <div id="quiz-start-screen" class="quiz-intro">
                    <div style="font-size:4rem; margin-bottom:20px">ğŸ“</div>
                    <h3>Ù‡Ù„ Ø£Ù†Øª Ù…Ø³ØªØ¹Ø¯ Ù„Ù„ØªØ­Ø¯ÙŠØŸ</h3>
                    <p style="margin-bottom:30px; color:var(--text-muted)">Ø§Ø®ØªØ¨Ø± Ù…Ø¹Ù„ÙˆÙ…Ø§ØªÙƒ ÙÙŠ Ø§Ù„ØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ù‚Ø¶Ø§Ø¦ÙŠ.</p>
                    <button class="btn-primary" onclick="quizManager.start()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¢Ù†</button>
                </div>

                <div id="quiz-play-area" class="hidden">
                    <div class="progress-container"><div class="progress-bar" id="quiz-progress"></div></div>
                    <div class="question-card">
                        <div style="margin-bottom:15px; display:flex; justify-content:space-between; color:var(--text-muted)">
                            <span id="q-number">Ø³Ø¤Ø§Ù„ 1</span>
                        </div>
                        <h3 id="q-text" style="font-size:1.4rem; margin-bottom:25px; line-height:1.6">Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„...</h3>
                        <div id="options-container"></div>
                    </div>
                    <div id="feedback-area" class="feedback-box">
                        <h4 id="fb-status" style="margin-bottom:10px"></h4>
                        <p id="fb-text" style="color:var(--text-main)"></p>
                        <p id="fb-source" style="margin-top:10px; font-size:0.9rem; opacity:0.8"></p>
                        <button class="btn-primary" style="margin-top:15px; padding:10px 25px" onclick="quizManager.next()">Ø§Ù„ØªØ§Ù„ÙŠ â¬…</button>
                    </div>
                </div>

                <div id="quiz-results" class="quiz-end hidden">
                    <div style="font-size:4rem; margin-bottom:20px">ğŸ†</div>
                    <h2>Ø§Ù„Ù†ØªÙŠØ¬Ø© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©</h2>
                    <div style="font-size:3rem; color:var(--success); margin:20px 0; font-weight:900"><span id="final-score">0</span>%</div>
                    <p id="result-msg" style="margin-bottom:30px"></p>
                    <button class="btn-primary" onclick="quizManager.reset()">Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©</button>
                </div>
            </section>

            <section id="flashcards-section" class="tab-content hidden fade-in">
                <header class="header-box">
                    <h2>Ø¨Ø·Ø§Ù‚Ø§Øª Ø§Ù„Ø°Ø§ÙƒØ±Ø©</h2>
                    <p>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ø·Ø§Ù‚Ø© Ù„Ù‚Ù„Ø¨Ù‡Ø§ ÙˆÙ…Ø¹Ø±ÙØ© Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</p>
                </header>
                <div class="flashcard-wrapper">
                    <div class="card" onclick="flashcardManager.flip()">
                        <div class="card__face card__face--front">
                            <span style="font-size:3rem; margin-bottom:20px">â“</span>
                            <h3 id="fc-front" style="font-size:1.4rem">Ø§Ù„Ø³Ø¤Ø§Ù„</h3>
                        </div>
                        <div class="card__face card__face--back">
                            <h3 id="fc-back" style="font-size:1.4rem; margin-bottom:15px">Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©</h3>
                            <p id="fc-source" style="font-size:0.9rem; opacity:0.8">Ø§Ù„Ù…ØµØ¯Ø±</p>
                        </div>
                    </div>
                    <div class="fc-controls">
                        <button class="btn-secondary" onclick="flashcardManager.prev()">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>
                        <span id="fc-counter" style="font-weight:bold; padding:10px">1 / 10</span>
                        <button class="btn-secondary" onclick="flashcardManager.next()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
                    </div>
                </div>
            </section>

            <section id="search-section" class="tab-content hidden fade-in">
                <header class="header-box">
                    <h2>Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ù…ØªÙ‚Ø¯Ù…</h2>
                    <div class="search-bar" style="position:relative; margin-top:15px">
                        <input type="text" id="search-input" placeholder="Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø© Ù„Ù„Ø¨Ø­Ø« (Ù…Ø«Ù„Ø§Ù‹: Ù…Ø­ÙƒÙ…Ø©ØŒ Ù‚Ø§Ø¶ÙŠ...)" onkeyup="app.search()">
                        <span class="search-icon">ğŸ”</span>
                    </div>
                </header>
                <div id="search-results" class="chapters-grid"></div>
            </section>

        </main>
    </div>

    <div id="modal" class="modal-overlay">
        <div class="modal-box">
            <button class="close-btn" onclick="app.closeModal()">Ã—</button>
            <div class="modal-header">
                <span id="modal-icon" style="font-size:2rem">ğŸ“„</span>
                <h2 id="modal-title">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</h2>
            </div>
            <div id="modal-content" class="modal-body"></div>
        </div>
    </div>

    <script>
        // --- Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ---
        const db = {
            review: [
                {
                    id: "principles", title: "Ø§Ù„Ù…Ø¨Ø§Ø¯Ø¦ Ø§Ù„Ù‚Ø¶Ø§Ø¦ÙŠØ©", icon: "ğŸ“œ",
                    desc: "Ø£Ø³Ø³ Ø§Ù„Ø¹Ø¯Ø§Ù„Ø©: Ø§Ù„Ø¹Ù„Ø§Ù†ÙŠØ©ØŒ Ø§Ù„Ù…Ø³Ø§ÙˆØ§Ø©ØŒ ÙˆØ§Ù„ØªÙ‚Ø§Ø¶ÙŠ Ø¹Ù„Ù‰ Ø¯Ø±Ø¬ØªÙŠÙ†.",
                    content: `<h3>1. Ø­Ù‚ Ø§Ù„Ù„Ø¬ÙˆØ¡ Ø¥Ù„Ù‰ Ø§Ù„Ù‚Ø¶Ø§Ø¡</h3><p>Ù…ÙƒÙÙˆÙ„ Ø¯Ø³ØªÙˆØ±ÙŠØ§Ù‹ Ø¨Ù…ÙˆØ¬Ø¨ Ø§Ù„Ù…Ø§Ø¯ØªÙŠÙ† 164 Ùˆ 165 Ù…Ù† Ø¯Ø³ØªÙˆØ± 2020.</p><h3>2. Ø¹Ù„Ø§Ù†ÙŠØ© Ø§Ù„Ø¬Ù„Ø³Ø§Øª</h3><p>Ø§Ù„Ø£ØµÙ„ Ù‡Ùˆ Ø§Ù„Ø¹Ù„Ø§Ù†ÙŠØ© (Ù… 169 Ø¯Ø³ØªÙˆØ±) Ù„Ø¶Ù…Ø§Ù† Ø§Ù„Ø´ÙØ§ÙÙŠØ©ØŒ ÙˆØ§Ù„Ø§Ø³ØªØ«Ù†Ø§Ø¡ Ù‡Ùˆ Ø§Ù„Ø³Ø±ÙŠØ© ÙÙŠ Ù‚Ø¶Ø§ÙŠØ§ Ø§Ù„Ø£Ø³Ø±Ø© ÙˆØ§Ù„Ø£Ø­Ø¯Ø§Ø«.</p>`
                },
                {
                    id: "ordinary_courts", title: "Ø§Ù„Ù‚Ø¶Ø§Ø¡ Ø§Ù„Ø¹Ø§Ø¯ÙŠ", icon: "ğŸ›ï¸",
                    desc: "Ø§Ù„Ù…Ø­ÙƒÙ…Ø©ØŒ Ø§Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„Ù‚Ø¶Ø§Ø¦ÙŠØŒ ÙˆØ§Ù„Ù…Ø­ÙƒÙ…Ø© Ø§Ù„Ø¹Ù„ÙŠØ§.",
                    content: `<h3>1. Ø§Ù„Ù…Ø­ÙƒÙ…Ø©</h3><p>Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ù‡Ø±Ù… Ø§Ù„Ù‚Ø¶Ø§Ø¦ÙŠØŒ ØªÙØµÙ„ Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„Ù†Ø²Ø§Ø¹Ø§Øª.</p><h3>2. Ø§Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„Ù‚Ø¶Ø§Ø¦ÙŠ</h3><p>Ø¬Ù‡Ø© Ø§Ø³ØªØ¦Ù†Ø§Ù (Ø¯Ø±Ø¬Ø© Ø«Ø§Ù†ÙŠØ©) ØªØªÙƒÙˆÙ† Ù…Ù† ØºØ±Ù Ù…ØªØ®ØµØµØ©.</p><h3>3. Ø§Ù„Ù…Ø­ÙƒÙ…Ø© Ø§Ù„Ø¹Ù„ÙŠØ§</h3><p>Ù…Ø­ÙƒÙ…Ø© Ù‚Ø§Ù†ÙˆÙ† ØªØ±Ø§Ù‚Ø¨ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø³Ù„ÙŠÙ… Ù„Ù„Ù‚Ø§Ù†ÙˆÙ† ÙˆÙ„Ø§ ØªÙ†Ø¸Ø± ÙÙŠ Ø§Ù„ÙˆÙ‚Ø§Ø¦Ø¹.</p>`
                },
                {
                    id: "specialized", title: "Ø§Ù„Ù…Ø­Ø§ÙƒÙ… Ø§Ù„Ù…ØªØ®ØµØµØ©", icon: "ğŸ”¨",
                    desc: "Ø§Ù„Ù…Ø­Ø§ÙƒÙ… Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© ÙˆØ§Ù„Ù…ØªØ®ØµØµØ© ÙˆØ§Ù„Ù…Ø­Ø§ÙƒÙ… Ø§Ù„Ø¹Ø³ÙƒØ±ÙŠØ©.",
                    content: `<h3>Ø§Ù„Ù…Ø­Ø§ÙƒÙ… Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ© Ø§Ù„Ù…ØªØ®ØµØµØ©</h3><p>ØªØªÙƒÙˆÙ† Ù…Ù† Ù‚Ø§Ø¶Ù Ø±Ø¦ÙŠØ³ Ùˆ4 Ù…Ø³Ø§Ø¹Ø¯ÙŠÙ† ÙŠØªÙ…ØªØ¹ÙˆÙ† Ø¨ØµÙˆØª ØªØ¯Ø§ÙˆÙ„ÙŠ.</p>`
                },
                {
                    id: "personnel", title: "Ø±Ø¬Ø§Ù„ Ø§Ù„Ù‚Ø¶Ø§Ø¡", icon: "ğŸ‘¥",
                    desc: "Ø§Ù„Ù‚Ø¶Ø§Ø©ØŒ Ø§Ù„Ù…Ø­Ø§Ù…ÙˆÙ†ØŒ ÙˆÙƒØªØ§Ø¨ Ø§Ù„Ø¶Ø¨Ø·.",
                    content: `<h3>Ø§Ù„Ù‚Ø§Ø¶ÙŠ</h3><p>ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙ…Ø§Ø±Ø³ Ù…Ù‡Ø§Ù…Ù‡ Ø¨Ø­ÙŠØ§Ø¯ ÙˆØ§Ø³ØªÙ‚Ù„Ø§Ù„ÙŠØ©. ÙŠÙ…Ù†Ø¹ Ø¹Ù„ÙŠÙ‡ Ù…Ù…Ø§Ø±Ø³Ø© Ø£ÙŠ Ù†Ø´Ø§Ø· ØªØ¬Ø§Ø±ÙŠ.</p>`
                }
            ],
            questions: [
                { q: "Ù…Ø§ Ù‡ÙŠ Ø§Ù„Ù…Ø­ÙƒÙ…Ø© Ø§Ù„ØªÙŠ ØªØ¹ØªØ¨Ø± 'Ù…Ø­ÙƒÙ…Ø© Ù‚Ø§Ù†ÙˆÙ†'ØŸ", options: ["Ø§Ù„Ù…Ø­ÙƒÙ…Ø© Ø§Ù„Ø§Ø¨ØªØ¯Ø§Ø¦ÙŠØ©", "Ø§Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„Ù‚Ø¶Ø§Ø¦ÙŠ", "Ø§Ù„Ù…Ø­ÙƒÙ…Ø© Ø§Ù„Ø¹Ù„ÙŠØ§", "Ù…Ø­ÙƒÙ…Ø© Ø§Ù„ØªÙ†Ø§Ø²Ø¹"], correct: 2, explanation: "Ø§Ù„Ù…Ø­ÙƒÙ…Ø© Ø§Ù„Ø¹Ù„ÙŠØ§ ØªØ±Ø§Ù‚Ø¨ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† ÙˆÙ„Ø§ ØªØ¹ÙŠØ¯ Ø§Ù„Ù†Ø¸Ø± ÙÙŠ Ø§Ù„ÙˆÙ‚Ø§Ø¦Ø¹.", citation: "Ø§Ù„Ù…Ø§Ø¯Ø© 152 Ù…Ù† Ø§Ù„Ø¯Ø³ØªÙˆØ±" },
                { q: "Ù…Ø¨Ø¯Ø£ Ø§Ù„ØªÙ‚Ø§Ø¶ÙŠ Ø¹Ù„Ù‰ Ø¯Ø±Ø¬ØªÙŠÙ† ÙŠØ¹Ù†ÙŠ:", options: ["ÙˆØ¬ÙˆØ¯ Ù…Ø­ÙƒÙ…ØªÙŠÙ† ÙÙ‚Ø·", "Ø¥Ù…ÙƒØ§Ù†ÙŠØ© Ø§Ø³ØªØ¦Ù†Ø§Ù Ø§Ù„Ø­ÙƒÙ…", "Ø¶Ø±ÙˆØ±Ø© ÙˆØ¬ÙˆØ¯ Ù‚Ø§Ø¶ÙŠÙŠÙ†", "Ø§Ù„ØªÙ‚Ø§Ø¶ÙŠ Ù…Ø±ØªÙŠÙ† ÙÙŠ Ù†ÙØ³ Ø§Ù„Ù…Ø­ÙƒÙ…Ø©"], correct: 1, explanation: "ÙŠØ¹Ù†ÙŠ Ø¥ØªØ§Ø­Ø© Ø§Ù„ÙØ±ØµØ© Ù„Ø·Ø±Ø­ Ø§Ù„Ù†Ø²Ø§Ø¹ Ù…Ø¬Ø¯Ø¯Ø§Ù‹ Ø£Ù…Ø§Ù… Ø¬Ù‡Ø© Ù‚Ø¶Ø§Ø¦ÙŠØ© Ø£Ø¹Ù„Ù‰.", citation: "Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø¯Ù†ÙŠØ©" },
                { q: "Ù…Ù† ÙŠÙØµÙ„ ÙÙŠ ØªÙ†Ø§Ø²Ø¹ Ø§Ù„Ø§Ø®ØªØµØ§Øµ Ø¨ÙŠÙ† Ø§Ù„Ù‚Ø¶Ø§Ø¡ Ø§Ù„Ø¹Ø§Ø¯ÙŠ ÙˆØ§Ù„Ø¥Ø¯Ø§Ø±ÙŠØŸ", options: ["Ø§Ù„Ù…Ø­ÙƒÙ…Ø© Ø§Ù„Ø¹Ù„ÙŠØ§", "Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¯ÙˆÙ„Ø©", "Ù…Ø­ÙƒÙ…Ø© Ø§Ù„ØªÙ†Ø§Ø²Ø¹", "Ø§Ù„Ù…Ø¬Ù„Ø³ Ø§Ù„Ø¯Ø³ØªÙˆØ±ÙŠ"], correct: 2, explanation: "Ù…Ø­ÙƒÙ…Ø© Ø§Ù„ØªÙ†Ø§Ø²Ø¹ Ù‡ÙŠ Ø§Ù„Ù‡ÙŠØ¦Ø© Ø§Ù„Ù…Ø®ØªØµØ© Ø­ØµØ±ÙŠØ§Ù‹ Ø¨Ø°Ù„Ùƒ.", citation: "Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¹Ø¶ÙˆÙŠ 98-03" }
            ],
            flashcards: [
                { q: "Ø¹Ø¯Ø¯ Ø§Ù„ØºØ±Ù ÙÙŠ Ø§Ù„Ù…Ø­ÙƒÙ…Ø© Ø§Ù„Ø¹Ù„ÙŠØ§", a: "7 ØºØ±Ù (Ù…Ø¯Ù†ÙŠØ©ØŒ Ø¹Ù‚Ø§Ø±ÙŠØ©ØŒ ØªØ¬Ø§Ø±ÙŠØ©...)", cite: "Ø§Ù„Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¹Ø¶ÙˆÙŠ" },
                { q: "Ù…Ù‡Ù„Ø© Ø±ÙØ¹ Ø¯Ø¹ÙˆÙ‰ Ø§Ù„Ø¥Ù„ØºØ§Ø¡", a: "4 Ø£Ø´Ù‡Ø± Ù…Ù† ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¨Ù„ÙŠØº", cite: "Ù‚Ø§Ù†ÙˆÙ† Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ù…Ø¯Ù†ÙŠØ©" },
                { q: "ØªØ´ÙƒÙŠÙ„Ø© Ø§Ù„Ù…Ø­ÙƒÙ…Ø© Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©", a: "Ù‚Ø§Ø¶Ù Ø±Ø¦ÙŠØ³ + 4 Ù…Ø³Ø§Ø¹Ø¯ÙŠÙ†", cite: "Ù‚Ø§Ù†ÙˆÙ† 22-13" }
            ]
        };

        // --- Ø§Ù„Ù…Ù†Ø·Ù‚ Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠ (Controller) ---
        const app = {
            init: function() {
                console.log("App Started...");
                this.loadTheme();
                this.renderReviews();
                quizManager.loadHistory();
                flashcardManager.init();
            },

            switchTab: function(tabId, btnElement) {
                // Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
                document.querySelectorAll('.tab-content').forEach(el => el.classList.add('hidden'));
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù‚Ø³Ù… Ø§Ù„Ù…Ø·Ù„ÙˆØ¨
                const target = document.getElementById(tabId + '-section');
                if(target) target.classList.remove('hidden');
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø£Ø²Ø±Ø§Ø±
                document.querySelectorAll('.nav-btn').forEach(btn => btn.classList.remove('active'));
                if(btnElement) btnElement.classList.add('active');
            },

            toggleDarkMode: function() {
                document.body.classList.toggle('dark-mode');
                localStorage.setItem('theme', document.body.classList.contains('dark-mode') ? 'dark' : 'light');
            },

            loadTheme: function() {
                if (localStorage.getItem('theme') === 'dark') document.body.classList.add('dark-mode');
            },

            renderReviews: function() {
                const container = document.getElementById('chapters-container');
                if(!container) return;
                container.innerHTML = db.review.map(item => `
                    <div class="chapter-card" onclick="app.openModal('${item.id}')">
                        <span class="card-icon">${item.icon}</span>
                        <div class="card-title">${item.title}</div>
                        <div class="card-desc">${item.desc}</div>
                    </div>
                `).join('');
            },

            openModal: function(id) {
                const item = db.review.find(i => i.id === id);
                if (!item) return;
                document.getElementById('modal-title').innerText = item.title;
                document.getElementById('modal-icon').innerText = item.icon;
                document.getElementById('modal-content').innerHTML = item.content;
                document.getElementById('modal').style.display = 'flex'; // Ø§Ø³ØªØ®Ø¯Ø§Ù… Flex Ù„Ù„ØªÙˆØ³ÙŠØ·
            },

            closeModal: function() {
                document.getElementById('modal').style.display = 'none';
            },

            search: function() {
                const query = document.getElementById('search-input').value.toLowerCase();
                const resultsDiv = document.getElementById('search-results');
                resultsDiv.innerHTML = '';
                
                if (query.length < 2) return;

                db.review.forEach(item => {
                    if (item.content.includes(query) || item.title.includes(query)) {
                        resultsDiv.innerHTML += `
                            <div class="chapter-card" onclick="app.openModal('${item.id}')">
                                <span class="card-icon">ğŸ“„</span><div class="card-title">${item.title}</div>
                            </div>`;
                    }
                });
            }
        };

        // --- Ù…Ø¯ÙŠØ± Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ---
        const quizManager = {
            questions: [], index: 0, score: 0,

            loadHistory: function() {
                const h = JSON.parse(localStorage.getItem('quizScore'));
                if(h) document.getElementById('high-score').innerText = h + '%';
            },

            start: function() {
                this.questions = [...db.questions].sort(() => 0.5 - Math.random());
                this.index = 0; this.score = 0;
                document.getElementById('quiz-start-screen').classList.add('hidden');
                document.getElementById('quiz-play-area').classList.remove('hidden');
                document.getElementById('quiz-results').classList.add('hidden'); // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø¸Ø§Ù‡Ø±Ø©
                this.showQuestion();
            },

            showQuestion: function() {
                const q = this.questions[this.index];
                document.getElementById('feedback-area').style.display = 'none';
                document.getElementById('q-number').innerText = `Ø³Ø¤Ø§Ù„ ${this.index + 1} Ù…Ù† ${this.questions.length}`;
                document.getElementById('q-text').innerText = q.q;
                document.getElementById('quiz-progress').style.width = ((this.index) / this.questions.length * 100) + '%';
                
                const cont = document.getElementById('options-container');
                cont.innerHTML = '';
                q.options.forEach((opt, idx) => {
                    const btn = document.createElement('div');
                    btn.className = 'option-btn';
                    btn.innerText = opt;
                    btn.onclick = () => this.check(idx, btn);
                    cont.appendChild(btn);
                });
            },

            check: function(idx, btn) {
                if(btn.classList.contains('disabled')) return;
                const q = this.questions[this.index];
                document.querySelectorAll('.option-btn').forEach(b => b.classList.add('disabled'));
                
                const fb = document.getElementById('feedback-area');
                const st = document.getElementById('fb-status');
                
                if(idx === q.correct) {
                    this.score++;
                    btn.classList.add('correct');
                    st.innerText = "Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! âœ…";
                    st.style.color = "var(--success)";
                } else {
                    btn.classList.add('wrong');
                    document.querySelectorAll('.option-btn')[q.correct].classList.add('correct');
                    st.innerText = "Ø¥Ø¬Ø§Ø¨Ø© Ø®Ø§Ø·Ø¦Ø© âŒ";
                    st.style.color = "var(--error)";
                }
                
                document.getElementById('fb-text').innerText = q.explanation;
                document.getElementById('fb-source').innerText = q.citation;
                fb.style.display = 'block';
            },

            next: function() {
                this.index++;
                if(this.index < this.questions.length) this.showQuestion();
                else this.finish();
            },

            finish: function() {
                document.getElementById('quiz-play-area').classList.add('hidden');
                document.getElementById('quiz-results').classList.remove('hidden');
                const final = Math.round((this.score / this.questions.length) * 100);
                document.getElementById('final-score').innerText = final;
                document.getElementById('result-msg').innerText = final >= 50 ? "Ø£Ø¯Ø§Ø¡ Ù…Ù…ØªØ§Ø²! ğŸ‰" : "Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰ ğŸ’ª";
                localStorage.setItem('quizScore', final);
            },
            
            reset: function() {
                this.start();
            }
        };

        // --- Ù…Ø¯ÙŠØ± Ø§Ù„Ø¨Ø·Ø§Ù‚Ø§Øª ---
        const flashcardManager = {
            index: 0,
            init: function() { this.render(); },
            render: function() {
                const item = db.flashcards[this.index];
                document.getElementById('fc-front').innerText = item.q;
                document.getElementById('fc-back').innerText = item.a;
                document.getElementById('fc-source').innerText = item.cite;
                document.getElementById('fc-counter').innerText = `${this.index + 1} / ${db.flashcards.length}`;
                document.querySelector('.card').classList.remove('is-flipped');
            },
            flip: function() { document.querySelector('.card').classList.toggle('is-flipped'); },
            next: function() { this.index = (this.index + 1) % db.flashcards.length; this.render(); },
            prev: function() { this.index = (this.index - 1 + db.flashcards.length) % db.flashcards.length; this.render(); }
        };

        // ØªØ´ØºÙŠÙ„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¹Ù†Ø¯ Ø§Ù„ØªØ­Ù…ÙŠÙ„
        window.onload = function() {
            app.init();
        };
    </script>
</body>
</html>
